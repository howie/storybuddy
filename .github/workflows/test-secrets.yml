name: Test Secrets Configuration

on:
  workflow_dispatch:

jobs:
  test-secrets:
    name: Verify Secrets Setup
    runs-on: ubuntu-latest

    steps:
      - name: Check ANTHROPIC_API_KEY
        env:
          ANTHROPIC_API_KEY: ${{ secrets.ANTHROPIC_API_KEY }}
        run: |
          if [ -z "$ANTHROPIC_API_KEY" ]; then
            echo "‚ùå ANTHROPIC_API_KEY is NOT set"
            exit 1
          else
            echo "‚úÖ ANTHROPIC_API_KEY is set (length: ${#ANTHROPIC_API_KEY})"
          fi

      - name: Check GH_PAT
        env:
          GH_PAT: ${{ secrets.GH_PAT }}
        run: |
          if [ -z "$GH_PAT" ]; then
            echo "‚ùå GH_PAT is NOT set"
            exit 1
          else
            echo "‚úÖ GH_PAT is set (length: ${#GH_PAT})"
          fi

      - name: Test Claude CLI Installation
        run: |
          echo "üì¶ Installing Claude CLI..."
          npm install -g @anthropic-ai/claude-code

          echo "‚úÖ Claude CLI installed"
          which claude || echo "‚ö†Ô∏è Claude CLI not found in PATH"

      - name: Summary
        run: |
          echo "================================"
          echo "‚úÖ All secrets are configured!"
          echo "================================"
          echo ""
          echo "Your CI/CD setup is ready."
          echo "Agent Auto-Fix should work now."
